Bootstrap: docker
From: fedora:27

%setup
cp -rf . $SINGULARITY_ROOTFS/src

%runscript
quit_solve "$@"

%files

%environment

%labels

%post

dnf install -y boost-static boost-devel cmake git gcc-c++ wget bzip2 make

cd /src
rm -rf build
mkdir build
cd build

wget bitbucket.org/eigen/eigen/get/3.2.10.tar.bz2
tar -xjf 3.2.10.tar.bz2

git clone https://github.com/intel/parallelstl.git
# source parallelstl/linux/pstlvars.sh intel64

MPI_HOME=/usr/lib64/mpich cmake .. -DEIGEN3_INCLUDE_DIR=../build/eigen-eigen-b9cd8366d4e8
make
make install
